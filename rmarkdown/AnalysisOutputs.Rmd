
---
title: "AnalysisOutputs"
author: "FlicAnderson"
date: "19/08/2020"
output: html_document
params: 
  yamlfile: NA
  sampleid: NA
  read_length_data_file: NA
---

### SETUP

NOTE: installed & added yaml, knitr & rmarkdown to the library() calls! Need to update documentation/installation etc too. 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

suppressMessages(library(here))
#suppressMessages(library(magrittr))
suppressMessages(library(knitr)) 
suppressMessages(library(yaml))
suppressMessages(library(tidyverse))


yamlfilepath <- params$yamlfile
sampleid <- params$sampleid
read_length_data_file <- params$read_length_data_file
```

```{r printparams}
print(yamlfilepath)

print(sampleid)

print(read_length_data_file)
```


```{r source_script, eval=FALSE, include=FALSE}

source(here::here("rscripts", "provenance.R"), local = knitr::knit_global())
source(here::here("rscripts", "read_count_functions.R"), local = knitr::knit_global())
source(here::here("rscripts", "stats_figs_block_functions.R"), local = knitr::knit_global())
# or sys.source("your-script.R", envir = knitr::knit_global())
```

```{r close_connections_1, include=FALSE}
# close any open hdf5 file connection
rhdf5::h5closeAll()
```

### PROVENANCE

```{r provenance, eval=FALSE, warning=FALSE, include=FALSE}
# handle interactive vs standard running

if(is.na(getopt::get_Rscript_filename())){
  this_script <- "AnalysisOutputs.Rmd"
  path_to_this_script <- here("rmarkdown", this_script)
} else {
  this_script <- getopt::get_Rscript_filename()
  path_to_this_script <- this_script
}

# print provenance
print_provenance(path_to_this_script)
```

## Sample Name: `r params$sampleid`

### Load Data: 

```{r}
read_length_data <- read_tsv(file = params$read_length_data_file, skip = 4, col_names = TRUE)

print(str(read_length_data))

```


### Plot: 

Plotting read lengths from input file. 

```{r plot_readlength}

#PlotReadLengths(read_length_data)

ggplot(read_length_data, aes(x = Length, y = Counts)) + geom_bar(stat = "identity")
```
